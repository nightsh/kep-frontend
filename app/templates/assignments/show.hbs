<style>
  .modal {
    max-width: 95%;
  }
</style>

{{#if match}}
{{else}}
  <div class="row">
    <div class="small-12 columns">
      <p class="text-center">
        {{assignment-timeline state=model.state aid=model.id}}
      </p>
    </div>
  </div>
{{/if}}
<div class="row">
  <div class="small-1 columns">&nbsp;</div>
  <div class="small-10 columns content">
    <h1 class="content-title">
      {{model.title}}
      <small>
        <span class="label secondary radius"><i>{{model.state}}</i></span>
      </small>
      <p class="byline"> {{user-byline modelName="assignment"}} </p>
    </h1>
    {{!--
    <small>by {{outlet 'username'}}</small>
    --}}
    <div class="row">
      <div class="small-6 columns"><hr></div>
      <div class="small-6 columns">
        {{!--
        <button class="button micro radius success"
          {{action 'match'}}>
          Match
        </button>
        --}}
        {{#if firstResourceId}}
          {{#if match}}
            <button class="button tiny secondary pull-right"
              {{action 'matchExit'}}>
              Exit match
            </button>
          {{else}}
            {{#if matchBase}}
            {{else}}
              {{#link-to 'resources.show' firstResourceId (query-params match=model.id) class="button tiny success pull-right"}}
                Enter Match
              {{/link-to}}
            {{/if}}
          {{/if}}
        {{/if}}
        <button href="#" id="drop1-btn" data-dropdown="drop1" aria-controls="drop1" aria-expanded="false" class="button tiny secondary dropdown pull-right">Actions</button><br>
        <ul id="drop1" data-dropdown-content class="f-dropdown" aria-hidden="true" aria-autoclose="false">
          {{#if model.is_owner}}
            <li class="choice-from-dropdown"><a href="#" {{action 'showAutomatchModal'}}>Show automatch users</a></li>
            <li class="choice-from-dropdown"><a href="#" {{action 'editAssignment'}}>Edit</a></li>
            {{#confirm-extension questionText='Do you really want to destroy this?' confirmText='Yes' declineText='No' confirmAction='deleteAssignment'}}
              <li class="choice-from-dropdown"><a href="#" >Delete</a></li>
            {{/confirm-extension}}
          {{else}}
            <li class="choice-from-dropdown"><a href="#" {{action 'addBid' model.id model.user_id}}>Take assignment</a></li>
          {{/if}}

        </ul>
      </div>
    </div>
    {{#if match}}
      <p></p>
    {{else}}
      <p>{{model.description}}</p>
    {{/if}}

    <ul class="small-block-grid-2 details-list">
      <li>
        <div class="panel radius callout">
          <ul>
            {{#each skill in model.skills}}
              <li>
                <span class="list-icon">
                  {{fa-icon skill.icon}}
                </span> 
                {{skill.name}} 
                <small> ({{skill.category}})</small>
              </li>
            {{/each}}
          </ul>
        </div>
      </li>
      <li>
        <div class="panel radius callout">
          <ul>
            {{#each reward in model.assignment_rewards}}
              <li>
                <span class="list-icon">
                  {{fa-icon reward.icon}}
                </span> 
                {{reward.reward}} 
              </li>
            {{/each}}
          </ul>
        </div>
      </li>
    </ul>

    {{!--
    <div class="pull-right">
    {{#if model.is_owner}}
      <ul class="button-group radius" style="position: relative;">
        <li><a href="#" class="button tiny" {{action 'editAssignment'}}>Edit</a></li>
        {{#confirm-extension questionText='Do you really want to destroy this?' confirmText='Yes' declineText='No' confirmAction='deleteAssignment'}}
          <li><a href="#" class="button tiny alert">Delete</a></li>
        {{/confirm-extension}}
      </ul>
    {{/if}}
    </div>
    --}}


{{#if match}}
{{else}}
  {{#if model.is_owner}}
    <div class="row">
      <div class="small-1 columns">&nbsp;</div>
      <div class="small-10 columns">
        <fieldset>
          <legend>Current bids:</legend>
            {{#each bid in model.assignment_bids}}
              <ol>
                <li>
                  <p>
                    User {{bid.user_id}} on assignment {{bid.assignment_id}}
                  </p>
                </li>
              </ol>
            {{/each}}
        </fieldset>
      </div>
      <div class="small-1 columns">&nbsp;</div>
    </div>
  {{/if}}
{{/if}}
  </div>
  <div class="small-1 columns">&nbsp;</div>


</div>


{{#if matchBase}}
{{else}}
  {{#if match}}
    <div class="row">
      <div class="small-4 columns"><hr></div>
      <div class="small-4 columns text-center">
        <button {{action 'showMatchModal'}} class="button radius tiny info">Review and match</button>
      </div>
      <div class="small-4 columns"><hr></div>
    </div>
  {{/if}}
{{/if}}

<div class="row">
  {{outlet 'match'}}
</div>

{{outlet}}
